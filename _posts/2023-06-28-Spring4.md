---
title: "[Spring] 싱글톤 컨테이너"
toc: true
toc_sticky: true
categories: 
    - Spring
tags:
    - Spring
---

본 포스트는 `Inflearn`의 김영한님 강의를 바탕으로 작성했습니다.

## **싱글톤 패턴을 사용하는 이유** <br><br>
![img1](/assets/images/4_1.png){: width="70%"", height="40%""} <br><br>

* 여러 클라이언트가 요청할 때마다 새로운 객체를 생성하는 것은 메모리 낭비가 심하다.
* 객체를 하나만 생성하고 이를 공유하도록 설계하자. -> **싱글톤 패턴** <br><br>

**싱글톤 패턴**
* 클래스의 인스턴스를 딱 1개만 생성되도록 보장하는 디자인 패턴이다. <br><br>

~~~java

public class SingletonService {
    private static final SingletonService instance = new SingletonService();
      public static SingletonService getInstance() {
          return instance;
      }

      private SingletonService() {
      }
      
      public void logic() { System.out.println("싱글톤 객체 로직 호출");
      } 
}
~~~

* 객체를 미리 생성해두고 생성자를 private으로 막아서 getInstance()를 통해서만 객체에 접근할 수 있게 한다.
* 유연성이 떨어지고 코드 길이도 길어지고 구체 클래스를 의존해야 되서 DIP, OCP를 위반할 가능성이 높다.
* 싱글톤 패턴 자체에 여러 문제가 있지만 이러한 것들은 Spring 이 다 해결해준다. <br><br>

![img2](/assets/images/4_2.png){: width="70%"", height="40%""} <br>

* 스프링 컨테이너는 요청이 올 때마다 객체를 생성하는 것이 아니라 미리 만들어둔 instance를 공유하는 방식으로 돌아간다.
* 객체 하나를 공유하는 방식이기 때문에 빈을 구현할 때 반드시 **stateless**로 설계해야 한다. <br><br>

**Configuration과 바이트 조작** <br>

![img3](/assets/images/4_3.png){: width="70%"", height="40%""} <br>

* 스프링 설정 정보로 넘긴 AppConfig도 빈으로 등록되는데 바이트조작된 AppConfig를 상속하는 객체가 빈으로 등록된다. (CGLIB 기술) <- @Configuration이 붙으면 해줌.
* @Configuration을 안 넣으면 @Bean이 붙은 method가 빈으로 등록되긴 하지만 싱글톤으로 관리되지 않는다.


# 출처
* https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8


